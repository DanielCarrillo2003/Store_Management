<% if current_user.cart_items.any? %>
    <% current_user.cart_items.each do |cart_item| %>
        <div class="card">
            <div class="card-body d-flex justify-content-between">
                <div style="width: 100px">
                    <%= image_tag cart_item.product.image, style: "width: 100px" %>
                </div>
                <div style="width: 250px">
                    <h5 class="card-title"> <%=cart_item.product.name%> </h5>
                    <p class="card-text">Cantidad: <%= cart_item.quantity %> </p>
                </div>
                <div class="mt-auto">
                    <%= form_for(cart_item, url: cart_item_path(cart_item), method: :delete, html: { class: 'delete-from-cart-form' }) do |f| %>
                        <%= f.button type: 'submit', class: 'btn btn-danger delete-button', data: { bs_toggle: 'tooltip', bs_placement: 'left', title: 'Quitar del carrito' } do %>
                            <i class="fa-solid fa-trash"></i>
                        <% end %>
                    <% end %>
                </div>
            </div>
        </div>
    <% end %>
<% else %>
    <h3>No has agregado ningun producto todavia</h3>
<% end %>


<script>
    $(document).ready(function() {
        $('.delete-from-cart-form').submit(function(e) {
            e.preventDefault();
            $.ajax({
                url: $(this).attr('action'),
                method: $(this).attr('method'),
                data: $(this).serialize(),
                success: function(response) {
                    $('#cartModalBody').html(response);
                },
                error: function(error) {
                    console.error('Error al eliminar el elemento del carrito:', error);
                }
            });
        });
    });
</script>